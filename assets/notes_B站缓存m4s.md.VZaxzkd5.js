import{_ as a,c as e,o as s,ag as i}from"./chunks/framework.oP1PDRBo.js";const h=JSON.parse('{"title":"超级详细，如何把B站缓存m4s文件转换成mp4格式","description":"","frontmatter":{},"headers":[],"relativePath":"notes/B站缓存m4s.md","filePath":"notes/B站缓存m4s.md","lastUpdated":1744448235000}'),p={name:"notes/B站缓存m4s.md"};function l(d,t,o,n,r,c){return s(),e("div",null,t[0]||(t[0]=[i(`<h1 id="超级详细-如何把b站缓存m4s文件转换成mp4格式" tabindex="-1">超级详细，如何把B站缓存m4s文件转换成mp4格式 <a class="header-anchor" href="#超级详细-如何把b站缓存m4s文件转换成mp4格式" aria-label="Permalink to &quot;超级详细，如何把B站缓存m4s文件转换成mp4格式&quot;">​</a></h1><h2 id="_1-视频缓存下来-找到m4s文件" tabindex="-1">1. 视频缓存下来，找到m4s文件 <a class="header-anchor" href="#_1-视频缓存下来-找到m4s文件" aria-label="Permalink to &quot;1. 视频缓存下来，找到m4s文件&quot;">​</a></h2><ol><li>首先我们将视频缓存下来，然后找到需要的m4s文件（已经找到m4s文件的可以跳过此步）</li></ol><p>在B站主界面点击我的，然后点击离线缓存，再点击右上角的设置，进入如下界面</p><ol start="2"><li>然后点击自定义目录，设置成你能找到的地方。然后点开想要转换的视频，右上角点击三点符号，出现如下界面，点击缓存，</li><li>点击缓存全部，然后查看缓存，等缓存完成。接下来将手机连接电脑，在电脑上的手机助手上打开文件管理，然后点击内部存储。这里以我的手机助手为例。</li><li>此电脑\\Redmi K60 Pro\\内部存储设备\\Android\\data\\tv.danmaku.bili\\download就是我刚才设置的b站缓存目录，</li><li>你可以找到你自己设置的目录点击打开，\\Android\\data进入二级目录</li><li>此处的tv. danmaku. bili文件即为B站缓存文件夹，</li><li>点击download，进入下一级目录</li><li>根据右边的修改时间，找到你刚才缓存的视频文件夹，点击，然后按照如下顺序依次点击，数字可能不同，但只要依次点击文件夹即可。</li><li>最后进入m4s文件存放界面</li><li>audio. m4s即音频文件，video. m4s即视频文件，将这两个文件拖到桌面备用</li></ol><h2 id="_2-下载ffmpeg工具" tabindex="-1">2. 下载ffmpeg工具 <a class="header-anchor" href="#_2-下载ffmpeg工具" aria-label="Permalink to &quot;2. 下载ffmpeg工具&quot;">​</a></h2><ol><li>FFmpeg 是一款免费开源的转换音频视频格式的程序工具，下载地址：</li></ol><p><a href="https://flist.jjaw.cn/%E8%BD%AF%E4%BB%B6/" target="_blank" rel="noreferrer">https://flist.jjaw.cn/软件/</a></p><p>复制后在浏览器打开，按照提示下载即可，下载的文件名字：ffmpeg-7.0.2-essentials_build.zip</p><p>下载解压后，依次点击，解压后的文件夹中应包含以下目录：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>bin：FFmpeg 可执行文件所在的文件夹，运行 FFmpeg 的所有命令都需通过此目录下的文件。</span></span>
<span class="line"><span>doc：文档资料。</span></span>
<span class="line"><span>presets：预设的格式和编码方案。</span></span>
<span class="line"><span>进入 bin 目录，可以看到 FFmpeg 的三个核心可执行文件：ffmpeg.exe、ffplay.exe、ffprobe.exe。</span></span></code></pre></div><ol start="2"><li><p>点击bin，进入bin。把刚才桌面上的audio. m4s文件和video文件拖到此界面，如图</p></li><li><p>找到“系统变量”中的 Path 条目并点击“编辑”。在“编辑环境变量”窗口中，点击“新建”，输入 FFmpeg 的 bin 文件夹路径。依次点击“确定”以保存设置（三个“确定”缺一不可）。</p></li><li><p>按 Win + R 键，输入 cmd 打开命令行窗口。</p></li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ffmpeg -version</span></span></code></pre></div><p>如果正确显示 FFmpeg 版本号和相关信息，说明安装成功。</p><h2 id="_3-使用ffmpeg工具" tabindex="-1">3. 使用ffmpeg工具 <a class="header-anchor" href="#_3-使用ffmpeg工具" aria-label="Permalink to &quot;3. 使用ffmpeg工具&quot;">​</a></h2><p>安装成功后，您可以使用命令行来执行 FFmpeg 的各种操作。常用的FFmpeg 命令行格式：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ffmpeg [global_options] {[input_file_options] -i input_url} ... {[output_file_options] output_url}</span></span></code></pre></div><p>示例：将 MP4视频 文件转换为 TS 格式，命令如下：</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ffmpeg -i &quot;C:\\Users\\moon.huang\\Desktop\\video.mp4&quot; -f mpegts -codec:v mpeg1video -b:v 2000k -r 30 -bf 0 -codec:a mp2 -ar 44100 -ac 1 -b:a 128k &quot;C:\\Users\\moon.huang\\Desktop\\video.ts&quot;</span></span></code></pre></div><ol><li>开始无损合并 将手机缓存的video.m4s与audio.m4s文件拷贝到电脑 ，放在同一目录。 .</li><li>然后按住键盘 Shift 键，在该目录空白处点击鼠标右键，打开命令窗口（黑的蓝的都行）： 输入命令并回车：</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ffmpeg -i video.m4s -i audio.m4s -codec copy output.mp4</span></span></code></pre></div><ol start="3"><li>注意：网上其他合并命令虽然也能用，但合并的东西可能是压制过的。如果你的合并速度比复制速度还慢，那说明肯定压制了视频或音频信息，不是无损压制的。</li><li>使用<code>ffplay</code>播放视频</li></ol><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>ffplay Output.mp4</span></span></code></pre></div><table tabindex="0"><thead><tr><th>参数</th><th>含义</th></tr></thead><tbody><tr><td>-i</td><td>输入文件路径（被转换的 MP4 文件）</td></tr><tr><td>-f</td><td>输出文件格式设置为 mpegts</td></tr><tr><td>-codec:v</td><td>指定视频编码器为 mpeg1video</td></tr><tr><td>-b:v</td><td>设置输出视频比特率为 2000k</td></tr><tr><td>-r</td><td>设置帧速率为 30</td></tr><tr><td>-bf</td><td>设置 B 帧数量为 0</td></tr><tr><td>-codec:a</td><td>指定音频编码器为 mp2</td></tr><tr><td>-ar</td><td>设置音频采样频率为 44100</td></tr><tr><td>-ac</td><td>设置音频通道数为 1</td></tr><tr><td>-b:a</td><td>设置音频比特率为 128k</td></tr></tbody></table><h2 id="简单方式" tabindex="-1">简单方式： <a class="header-anchor" href="#简单方式" aria-label="Permalink to &quot;简单方式：&quot;">​</a></h2><p>在空白处按住shift键，然后单击鼠标右键，选择在此处打开powershell窗口</p><div class="language- vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang"></span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>.\\ffmpeg.exe -i video.m4s -i audio.m4s -codec copy Output.mp4</span></span></code></pre></div><p>这串代码，然后在这个蓝色界面内单击右键，将这款代码粘贴进去，然后按回车键，出现如下代码即表示转换成功</p><p>此时我们切换到刚才的bin文件夹，发现生成了一个output文件，此文件就是刚才的audio. m4s，video. m4s合成的mp4文件</p><p>我们可以发现output文件的大小近似等于两个m4s文件的大小之和。说明用这种方法可以无损合成，这个output文件与你原先缓存的视频完全相同。</p>`,30)]))}const u=a(p,[["render",l]]);export{h as __pageData,u as default};
